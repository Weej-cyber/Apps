<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SmartPromptz - Weej App</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', -apple-system, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
      color: #333;
    }
    
    .app-container {
      max-width: 1200px;
      margin: auto;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      box-shadow: 0 25px 50px rgba(0,0,0,0.15);
      overflow: hidden;
    }
    
    /* Header with Logo */
    .header {
      background: linear-gradient(135deg, #1a1a1a, #333333);
      padding: 25px 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-bottom: 3px solid #dc2626;
    }
    
    .logo-section {
      display: flex;
      align-items: center;
      gap: 20px;
    }
    
    .header .weej-logo {
      width: 158px;
      height: auto;
    }
    
    .app-info {
      color: white;
    }
    
    .app-title {
      font-size: 26px;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 0;
    }
    
    .app-subtitle {
      font-size: 15px;
      color: #f3f4f6;
      font-weight: 600;
    }
    
    .powered-by {
      font-size: 13px;
      color: #e5e7eb;
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 500;
    }
    
    /* Main Content */
    .content {
      padding: 40px;
    }
    
    .mode-selector {
      background: linear-gradient(135deg, #f8fafc, #e2e8f0);
      border-radius: 16px;
      padding: 25px;
      margin-bottom: 30px;
      border-left: 5px solid #dc2626;
    }
    
    .mode-title {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 15px;
      color: #1e293b;
    }
    
    .radio-group {
      display: flex;
      gap: 25px;
      flex-wrap: wrap;
      justify-content: flex-start;
    }
    
    .radio-option {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 15px 20px;
      background: white;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid transparent;
      box-shadow: 0 4px 15px rgba(0,0,0,0.05);
    }
    
    .radio-option:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    }
    
    .radio-option.active {
      border-color: #dc2626;
      background: linear-gradient(135deg, #fef2f2, #fee2e2);
    }
    
    .radio-option input[type="radio"] {
      width: 18px;
      height: 18px;
      accent-color: #dc2626;
    }
    
    .radio-option label {
      font-weight: 600;
      color: #374151;
      cursor: pointer;
    }
    
    /* Template Section */
    .template-section {
      background: linear-gradient(135deg, #fff7ed, #fed7aa);
      border-radius: 16px;
      padding: 25px;
      margin-bottom: 30px;
      border-left: 5px solid #f59e0b;
      display: none;
    }
    
    .template-section.show {
      display: block;
      animation: slideIn 0.3s ease;
    }
    
    @keyframes slideIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .template-description {
      font-style: italic;
      margin-top: 10px;
      color: #92400e;
      background: rgba(251, 191, 36, 0.1);
      padding: 10px;
      border-radius: 8px;
    }
    
    /* Form Section */
    .form-section {
      background: white;
      border-radius: 16px;
      padding: 35px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.08);
      border: 1px solid #e5e7eb;
    }
    
    .form-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 25px;
      margin-bottom: 25px;
    }
    
    .form-group {
      display: flex;
      flex-direction: column;
    }
    
    .form-group.full-width {
      grid-column: 1 / -1;
    }
    
    .form-label {
      font-weight: 700;
      color: #1f2937;
      margin-bottom: 8px;
      font-size: 16px;
    }
    
    .required::after {
      content: " *";
      color: #dc2626;
    }
    
    .form-input, .form-textarea, .form-select {
      padding: 15px;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      font-size: 16px;
      transition: all 0.3s ease;
      background: #fafafa;
      font-family: inherit;
    }
    
    .form-input:focus, .form-textarea:focus, .form-select:focus {
      outline: none;
      border-color: #dc2626;
      background: white;
      box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1);
    }
    
    .form-hint {
      font-size: 13px;
      color: #6b7280;
      margin-top: 5px;
      font-style: italic;
    }
    
    /* Action Buttons */
    .action-buttons {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      justify-content: center;
      margin: 30px 0;
    }
    
    .btn {
      padding: 15px 30px;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-family: inherit;
      position: relative;
      overflow: hidden;
    }
    
    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none !important;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #4CAF50, #66BB6A);
      color: white;
      box-shadow: 0 6px 20px rgba(76, 175, 80, 0.3);
    }
    
    .btn-secondary {
      background: linear-gradient(135deg, #2196F3, #42A5F5);
      color: white;
      box-shadow: 0 6px 20px rgba(33, 150, 243, 0.3);
    }
    
    .btn-accent {
      background: linear-gradient(135deg, #6B7280, #9CA3AF);
      color: white;
      box-shadow: 0 6px 20px rgba(107, 114, 128, 0.3);
    }
    
    .btn:hover:not(:disabled) {
      transform: translateY(-3px);
      box-shadow: 0 12px 40px rgba(0,0,0,0.2);
    }
    
    .btn.loading {
      pointer-events: none;
    }
    
    .btn.loading::after {
      content: "";
      position: absolute;
      width: 20px;
      height: 20px;
      margin: auto;
      border: 2px solid transparent;
      border-top-color: #ffffff;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
    
    @keyframes spin {
      0% { transform: translate(-50%, -50%) rotate(0deg); }
      100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    
    /* Output Section */
    .output-section {
      background: white;
      border-radius: 20px;
      margin-top: 30px;
      min-height: 200px;
      box-shadow: 0 15px 50px rgba(0,0,0,0.15);
      overflow: hidden;
      border: 1px solid #e5e7eb;
    }
    
    .output-header {
      background: linear-gradient(135deg, #1a1a1a, #333333);
      padding: 20px 30px;
      display: flex;
      align-items: center;
      gap: 15px;
      border-bottom: 3px solid #dc2626;
    }
    
    .output-header .weej-logo {
      width: 97px;
      height: auto;
    }
    
    .output-header .header-text {
      color: white;
      font-size: 20px;
      font-weight: 700;
    }
    
    .output-content {
      padding: 30px;
      font-family: 'Segoe UI', -apple-system, sans-serif;
      font-size: 16px;
      line-height: 1.6;
      color: #1e293b;
      min-height: 120px;
      white-space: pre-wrap;
      word-wrap: break-word;
    }
    
    .output-placeholder {
      color: #9ca3af;
      font-style: italic;
    }
    
    /* Usage Instructions */
    .usage-instructions {
      background: linear-gradient(135deg, #f0fdf4, #dcfce7);
      border-top: 1px solid #e5e7eb;
      padding: 25px 30px;
      border-radius: 0 0 20px 20px;
    }
    
    .instruction-header {
      font-size: 18px;
      font-weight: 700;
      color: #166534;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .instruction-header::before {
      content: "🚀";
      font-size: 20px;
    }
    
    .instruction-text {
      color: #374151;
      line-height: 1.6;
      margin-bottom: 15px;
    }
    
    .ai-platforms {
      display: block;
      font-size: 14px;
      color: #6b7280;
      font-style: italic;
      margin-top: 8px;
    }
    
    .instruction-actions {
      display: flex;
      align-items: center;
      gap: 15px;
      flex-wrap: wrap;
    }
    
    .copy-btn {
      background: linear-gradient(135deg, #059669, #10b981);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .copy-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(5, 150, 105, 0.3);
    }
    
    .copy-success {
      color: #059669;
      font-weight: 600;
      font-size: 14px;
    }
    
    /* Toast Notifications */
    .toast {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #1f2937;
      color: white;
      padding: 15px 20px;
      border-radius: 10px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      z-index: 1000;
      transform: translateX(400px);
      transition: transform 0.3s ease;
    }
    
    .toast.show {
      transform: translateX(0);
    }
    
    .toast.success {
      background: linear-gradient(135deg, #059669, #10b981);
    }
    
    .toast.error {
      background: linear-gradient(135deg, #dc2626, #ef4444);
    }
    
    /* Responsive Design */
    @media (max-width: 768px) {
      .header {
        flex-direction: column;
        text-align: center;
        gap: 15px;
      }
      
      .form-grid {
        grid-template-columns: 1fr;
      }
      
      .content {
        padding: 25px;
      }
      
      .header .weej-logo {
        width: 121px;
      }
      
      .radio-group {
        justify-content: flex-start;
      }
      
      .action-buttons {
        justify-content: center;
      }
      
      .instruction-actions {
        justify-content: center;
      }
    }
    
    /* Modern Visual Enhancements */
    .card-hover {
      transition: all 0.3s ease;
    }
    
    .card-hover:hover {
      transform: translateY(-5px);
      box-shadow: 0 20px 60px rgba(0,0,0,0.15);
    }
    
    /* Error States */
    .error {
      border-color: #ef4444 !important;
      background: #fef2f2 !important;
    }
    
    .error-message {
      color: #dc2626;
      font-size: 14px;
      margin-top: 5px;
      font-weight: 600;
    }
    
    /* Success States */
    .success {
      border-color: #10b981 !important;
      background: #f0fdf4 !important;
    }
    
    /* Loading States */
    .loading-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(255, 255, 255, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 100;
      backdrop-filter: blur(2px);
    }
    
    .spinner {
      width: 40px;
      height: 40px;
      border: 4px solid #e5e7eb;
      border-top-color: #dc2626;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
  </style>
</head>
<body>
  <div class="app-container">
    
    <!-- Header with Weej Logo -->
    <div class="header">
      <div class="logo-section">
        <!-- Weej Logo -->
        <svg class="weej-logo" viewBox="0 0 320 80" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <linearGradient id="logoGrad" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#dc2626;stop-opacity:1" />
              <stop offset="50%" style="stop-color:#ef4444;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#f87171;stop-opacity:1" />
            </linearGradient>
            <filter id="logoShadow">
              <feDropShadow dx="2" dy="3" stdDeviation="2" flood-color="#000000" flood-opacity="0.4"/>
            </filter>
          </defs>
          <text x="40" y="55" font-family="Impact, Arial Black, sans-serif" font-size="60" font-weight="900" fill="url(#logoGrad)" filter="url(#logoShadow)">&lt;</text>
          <text x="160" y="55" font-family="Impact, Arial Black, sans-serif" font-size="60" font-weight="900" text-anchor="middle" fill="#ffffff" filter="url(#logoShadow)">Weej</text>
          <text x="240" y="55" font-family="Impact, Arial Black, sans-serif" font-size="60" font-weight="900" fill="url(#logoGrad)" filter="url(#logoShadow)">/</text>
          <text x="260" y="55" font-family="Impact, Arial Black, sans-serif" font-size="60" font-weight="900" fill="url(#logoGrad)" filter="url(#logoShadow)">&gt;</text>
        </svg>
        
        <div class="app-info">
          <div class="app-title">SmartPromptz</div>
        </div>
      </div>
    </div>
    
    <!-- Main Content -->
    <div class="content">
      
      <!-- Mode Selection -->
      <div class="mode-selector card-hover">
        <div class="mode-title">How would you like to start?</div>
        <div class="radio-group">
          <div class="radio-option active" onclick="toggleMode('custom')">
            <input type="radio" name="mode" value="custom" checked onchange="toggleMode()">
            <label>Start from scratch</label>
          </div>
          <div class="radio-option" onclick="toggleMode('template')">
            <input type="radio" name="mode" value="template" onchange="toggleMode()">
            <label>Use a prompt template</label>
          </div>
        </div>
      </div>
      
      <!-- Template Section -->
      <div class="template-section" id="templateSection">
        <div class="mode-title">Choose Your Template</div>
        <div class="form-group">
          <label class="form-label" for="template">Select Template</label>
          <select class="form-select" id="template" onchange="applyTemplate()">
            <option value="">-- Choose a template --</option>
            <option value="summarizer">📄 Summarizer</option>
            <option value="idea_gen">💡 Idea Generator</option>
            <option value="email_writer">📧 Email Writer</option>
            <option value="user_story">👤 User Story Builder</option>
            <option value="req_clarifier">❓ Requirements Clarifier</option>
            <option value="scenario_question">🎯 Scenario-Based Question Creator</option>
            <option value="persona_gen">🎭 Persona Generator</option>
            <option value="story_starter">📖 Story Starter</option>
            <option value="process_explainer">⚙️ Process Explainer</option>
            <option value="code_helper">💻 Code Helper</option>
          </select>
          <div class="template-description" id="template-description" style="display: none;"></div>
        </div>
      </div>
      
      <!-- Main Form -->
      <div class="form-section card-hover">
        <div class="form-grid">
          
          <div class="form-group full-width">
            <label class="form-label" for="role">AI Role</label>
            <textarea class="form-input" id="role" placeholder="e.g., You are a marketing expert, technical writer, creative storyteller..." maxlength="200"></textarea>
            <div class="form-hint">Define what type of expert or assistant the AI should be (optional)</div>
          </div>
          
          <div class="form-group full-width">
            <label class="form-label required" for="goal">Goal</label>
            <textarea class="form-input" id="goal" placeholder="What do you want the AI to accomplish?" maxlength="300" required></textarea>
            <div class="form-hint">Be specific about your desired outcome</div>
          </div>
          
          <div class="form-group full-width">
            <label class="form-label" for="context">Context</label>
            <textarea class="form-textarea" id="context" rows="3" placeholder="Provide background information or important details..." maxlength="1000"></textarea>
            <div class="form-hint">Who, what, when, why - add relevant background</div>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="format">Output Format</label>
            <select class="form-select" id="format">
              <option value="">Choose format...</option>
              <option value="paragraph">📝 Paragraph</option>
              <option value="list">📋 List</option>
              <option value="table">📊 Table</option>
              <option value="code">💻 Code block</option>
              <option value="dialogue">💬 Dialogue</option>
              <option value="step-by-step">🔢 Step-by-step</option>
            </select>
            <div class="form-hint">How should the response be structured?</div>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="tone">Tone/Style</label>
            <textarea class="form-input" id="tone" placeholder="e.g., Professional, casual, witty" maxlength="100"></textarea>
            <div class="form-hint">Define the voice and personality</div>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="constraints">Constraints</label>
            <textarea class="form-input" id="constraints" placeholder="e.g., Keep under 100 words, use simple language" maxlength="200"></textarea>
            <div class="form-hint">Any limits or specific requirements</div>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="examples">Examples</label>
            <textarea class="form-textarea" id="examples" rows="2" placeholder="Show sample outputs to guide the AI..." maxlength="500"></textarea>
            <div class="form-hint">Optional examples of desired output</div>
          </div>
          
        </div>
        
        <div class="action-buttons">
          <button class="btn btn-primary" onclick="generatePrompt()" id="generateBtn">
            <span>Craft Prompt</span>
          </button>
          <button class="btn btn-secondary" onclick="refinePrompt()" id="refineBtn">
            <span>Refine Prompt</span>
          </button>
          <button class="btn btn-accent" onclick="savePrompt()" id="saveBtn">
            <span>Save to File</span>
          </button>
        </div>
        
      </div>
      
      <!-- Output Section -->
      <div class="output-section">
        <div class="output-header">
          <!-- Weej Logo -->
          <svg class="weej-logo" viewBox="0 0 320 80" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <linearGradient id="outputLogoGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#dc2626;stop-opacity:1" />
                <stop offset="50%" style="stop-color:#ef4444;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#f87171;stop-opacity:1" />
              </linearGradient>
              <filter id="outputLogoShadow">
                <feDropShadow dx="2" dy="3" stdDeviation="2" flood-color="#000000" flood-opacity="0.4"/>
              </filter>
            </defs>
            <text x="40" y="55" font-family="Impact, Arial Black, sans-serif" font-size="60" font-weight="900" fill="url(#outputLogoGrad)" filter="url(#outputLogoShadow)">&lt;</text>
            <text x="160" y="55" font-family="Impact, Arial Black, sans-serif" font-size="60" font-weight="900" text-anchor="middle" fill="#ffffff" filter="url(#outputLogoShadow)">Weej</text>
            <text x="240" y="55" font-family="Impact, Arial Black, sans-serif" font-size="60" font-weight="900" fill="url(#outputLogoGrad)" filter="url(#outputLogoShadow)">/</text>
            <text x="260" y="55" font-family="Impact, Arial Black, sans-serif" font-size="60" font-weight="900" fill="url(#outputLogoGrad)" filter="url(#outputLogoShadow)">&gt;</text>
          </svg>
          
          <div class="header-text">Generated Prompt</div>
        </div>
        
        <div class="output-content" id="output">
          <div class="output-placeholder">Your custom-generated prompt will appear here...</div>
        </div>
        
        <div class="usage-instructions" id="usage-instructions" style="display: none;">
          <div class="instruction-header">Ready to Use!</div>
          <div class="instruction-text">
            <strong>Your professional prompt is complete.</strong> Copy the text above and paste it into ChatGPT, Claude, or any AI assistant to get precisely what you're looking for.
            <span class="ai-platforms">✨ Works great with: ChatGPT • Claude • Gemini • Perplexity • Copilot • or any other AI platform</span>
          </div>
          <div class="instruction-actions">
            <button class="copy-btn" onclick="copyPromptToClipboard()">📋 Copy to Clipboard</button>
            <span class="copy-success" id="copy-success" style="display: none;">✅ Copied!</span>
          </div>
        </div>
      </div>
      
    </div>
  </div>
  
  <script>
    "use strict";
    
    // Template definitions with complete information
    const templates = {
      summarizer: {
        role: "You are a professional content summarizer and analyst",
        goal: "Summarize the following content into clear, actionable key points",
        context: "Extract the most important information from long text while preserving context and meaning",
        tone: "Professional and concise",
        format: "list",
        constraints: "Keep under 200 words, focus on actionable insights",
        examples: "• Main point 1: [key insight with context]\n• Main point 2: [important detail with implications]\n• Key takeaway: [actionable conclusion]",
        description: "Perfect for condensing articles, reports, or documents into digestible summaries with actionable insights."
      },
      idea_gen: {
        role: "You are a creative brainstorming expert and innovation consultant",
        goal: "Generate creative and practical ideas for a specific project or challenge",
        context: "Brainstorming session focused on innovative solutions that are both creative and feasible",
        tone: "Creative, energetic, and solution-focused",
        format: "list",
        constraints: "Provide 5-10 unique ideas, mix of quick wins and bold innovations",
        examples: "1. [Creative concept] - [brief implementation note]\n2. [Innovative approach] - [potential impact]\n3. [Unique solution] - [why it works]",
        description: "Great for brainstorming campaigns, product features, or solving creative business challenges with fresh perspectives."
      },
      email_writer: {
        role: "You are a professional business communication expert specializing in effective email writing",
        goal: "Write a professional, clear, and action-oriented email",
        context: "Business communication requiring clear messaging, appropriate tone, and specific outcomes",
        tone: "Professional, courteous, and purposeful",
        format: "paragraph",
        constraints: "Keep concise but complete, include clear subject line and call-to-action",
        examples: "Subject: [Clear, specific subject line]\n\nHi [Name],\n\n[Opening context and purpose]\n[Main message with details]\n[Clear next steps or call-to-action]\n\nBest regards,\n[Your name]",
        description: "For crafting professional emails, client communications, team updates, or business correspondence that gets results."
      },
      user_story: {
        role: "You are an agile development expert and product manager",
        goal: "Create detailed user stories for agile development with clear acceptance criteria",
        context: "Software development planning requiring user-focused requirements and technical clarity",
        tone: "Clear, technical, and user-focused",
        format: "paragraph",
        constraints: "Follow 'As a... I want... So that...' format, include acceptance criteria",
        examples: "As a [specific user type], I want [detailed functionality] so that [clear business value].\n\nAcceptance Criteria:\n• [Specific behavior 1]\n• [Specific behavior 2]\n• [Edge case handling]",
        description: "Essential for agile teams to define features from user perspective with clear technical requirements and success criteria."
      },
      req_clarifier: {
        role: "You are a business analyst and requirements expert specializing in project clarification",
        goal: "Break down vague requirements into specific, actionable specifications",
        context: "Project planning where requirements need to be clarified, detailed, and made actionable",
        tone: "Analytical, thorough, and consultative",
        format: "list",
        constraints: "Ask specific, probing questions that lead to actionable answers",
        examples: "Key Clarification Questions:\n1. What specific outcomes define success for this project?\n2. Who are the primary and secondary users?\n3. What are the must-have vs. nice-to-have features?\n4. What are the technical and business constraints?",
        description: "Helps transform unclear requests into detailed specifications by asking the right questions to uncover true requirements."
      },
      scenario_question: {
        role: "You are an expert interviewer and behavioral assessment designer",
        goal: "Create realistic scenario-based questions for interviews, training, or assessment",
        context: "Evaluation scenario requiring practical problem-solving and decision-making skills",
        tone: "Professional, challenging, and realistic",
        format: "paragraph",
        constraints: "Include realistic context, specific challenges, and clear evaluation criteria",
        examples: "Scenario: [Detailed, realistic workplace situation]\n\nChallenge: [Specific problem to solve]\n\nYour task: [Clear instructions on what to address]\n\nConsider: [Key factors to evaluate in response]",
        description: "Perfect for creating interview questions, training scenarios, or skill assessments that reveal practical problem-solving abilities."
      },
      persona_gen: {
        role: "You are a UX researcher and customer insights expert",
        goal: "Generate detailed, research-based user personas for design and product development",
        context: "UX research and product development requiring deep user understanding and empathy",
        tone: "Descriptive, empathetic, and data-driven",
        format: "paragraph",
        constraints: "Include demographics, psychographics, goals, pain points, and behavioral patterns",
        examples: "**[Persona Name]** - [Job Title/Role]\n\n**Demographics:** [Age, location, background]\n**Goals:** [Primary objectives and motivations]\n**Pain Points:** [Key challenges and frustrations]\n**Behaviors:** [How they interact with products/services]\n**Quote:** '[Typical thing they might say]'",
        description: "Creates realistic, research-based user profiles to guide product decisions, design choices, and marketing strategies."
      },
      story_starter: {
        role: "You are a creative writing expert and master storyteller",
        goal: "Begin a compelling narrative that hooks readers and establishes strong foundations",
        context: "Creative writing project requiring engaging opening, character development, or world-building",
        tone: "Engaging, descriptive, and compelling",
        format: "paragraph",
        constraints: "Hook the reader immediately, establish setting and character, create intrigue",
        examples: "[Opening with vivid scene-setting and immediate tension or intrigue that makes the reader want to continue...]",
        description: "Kickstarts creative writing projects with engaging opening scenes, character introductions, or world-building that captivates readers."
      },
      process_explainer: {
        role: "You are a technical documentation expert and process improvement specialist",
        goal: "Explain complex processes in clear, logical, easy-to-follow steps",
        context: "Documentation or training requiring step-by-step clarity and practical implementation",
        tone: "Clear, educational, and systematic",
        format: "step-by-step",
        constraints: "Break into logical sequential steps, include tips and common pitfalls",
        examples: "**Step 1:** [Clear action with specific details]\n- Tip: [Helpful guidance]\n- Watch out for: [Common mistake]\n\n**Step 2:** [Next logical action]\n- Why this matters: [Explanation of importance]",
        description: "Transforms complex workflows, procedures, or systems into easy-to-follow instructions that anyone can implement successfully."
      },
      code_helper: {
        role: "You are a senior software developer and technical mentor",
        goal: "Help with coding tasks, provide code review, or explain programming concepts",
        context: "Software development assistance requiring best practices, clean code, and educational explanations",
        tone: "Technical, precise, and educational",
        format: "code",
        constraints: "Include comments, follow best practices, explain reasoning behind choices",
        examples: "```javascript\n// Purpose: [What this code does]\nfunction exampleFunction(param) {\n  // Implementation with clear logic\n  return result;\n}\n\n// Usage example:\n// [How to use this code]\n```",
        description: "Assists with writing, reviewing, or explaining code with focus on best practices, readability, and educational value."
      }
    };

    // Global state management with validation
    let appState = {
      currentMode: 'custom',
      isGenerating: false,
      lastPrompt: null,
      validationErrors: [],
      initialized: false
    };

    // Enhanced mode switching functionality with error handling
    function toggleMode(mode) {
      try {
        if (!document.getElementById) {
          console.error('DOM not ready');
          return;
        }

        const templateSection = document.getElementById('templateSection');
        const radioOptions = document.querySelectorAll('.radio-option');
        
        if (!templateSection || radioOptions.length === 0) {
          console.error('Required DOM elements not found');
          return;
        }
        
        // Clear previous state
        clearErrors();
        hideToast();
        
        // Update radio button states
        radioOptions.forEach(option => option.classList.remove('active'));
        
        if (mode) {
          // Called directly with parameter
          const targetOption = mode === 'template' ? 
            document.querySelector('.radio-option:nth-child(2)') : 
            document.querySelector('.radio-option:nth-child(1)');
          
          if (targetOption) {
            targetOption.classList.add('active');
            
            // Update radio button
            const radio = document.querySelector(`input[value="${mode}"]`);
            if (radio) radio.checked = true;
          }
        } else {
          // Called from radio change event
          const checkedRadio = document.querySelector('input[name="mode"]:checked');
          if (checkedRadio) {
            mode = checkedRadio.value;
            const parentOption = checkedRadio.closest('.radio-option');
            if (parentOption) parentOption.classList.add('active');
          }
        }
        
        appState.currentMode = mode || 'custom';
        
        // Show/hide template section
        if (mode === 'template') {
          templateSection.classList.add('show');
        } else {
          templateSection.classList.remove('show');
          // Clear template selection when switching to custom mode
          const templateSelect = document.getElementById('template');
          const description = document.getElementById('template-description');
          if (templateSelect) templateSelect.value = '';
          if (description) {
            description.textContent = '';
            description.style.display = 'none';
          }
        }
        
        // Hide usage instructions when switching modes
        const instructionsElement = document.getElementById('usage-instructions');
        if (instructionsElement) {
          instructionsElement.style.display = 'none';
        }
        
      } catch (error) {
        console.error('Error in toggleMode:', error);
        showToast('An error occurred while switching modes', 'error');
      }
    }

    // Enhanced template application functionality with validation
    function applyTemplate() {
      try {
        const templateSelect = document.getElementById('template');
        const description = document.getElementById('template-description');
        
        if (!templateSelect || !description) {
          console.error('Template elements not found');
          return;
        }
        
        const templateId = templateSelect.value;
        
        if (templateId && templates[templateId]) {
          const template = templates[templateId];
          
          // Populate form fields with validation
          const fields = ['role', 'goal', 'context', 'tone', 'format', 'constraints', 'examples'];
          let fieldsPopulated = 0;
          
          fields.forEach(field => {
            const element = document.getElementById(field);
            if (element && template[field]) {
              element.value = template[field];
              // Clear any error states
              element.classList.remove('error');
              clearFieldError(field);
              fieldsPopulated++;
            }
          });
          
          // Show description with animation
          description.textContent = template.description;
          description.style.display = 'block';
          
          if (fieldsPopulated > 0) {
            showToast('Template applied successfully!', 'success');
          } else {
            showToast('Template loaded but no fields were populated', 'error');
          }
          
        } else {
          // Clear description if no template selected
          description.textContent = '';
          description.style.display = 'none';
        }
      } catch (error) {
        console.error('Error in applyTemplate:', error);
        showToast('Error applying template', 'error');
      }
    }

    // Enhanced prompt generation with comprehensive validation
    function generatePrompt() {
      if (appState.isGenerating) return;
      
      try {
        // Clear previous errors and state
        clearErrors();
        appState.validationErrors = [];
        
        // Get form values with trimming and null checking
        const formData = {
          role: getElementValue('role'),
          goal: getElementValue('goal'),
          context: getElementValue('context'),
          format: getElementValue('format'),
          tone: getElementValue('tone'),
          constraints: getElementValue('constraints'),
          examples: getElementValue('examples')
        };
        
        // Enhanced validation
        const validationResults = validateForm(formData);
        
        if (!validationResults.isValid) {
          validationResults.errors.forEach(error => {
            showFieldError(error.field, error.message);
          });
          showToast('Please fix the errors below before generating', 'error');
          return;
        }
        
        // Set loading state
        setLoadingState(true);
        
        // Simulate processing time for better UX
        setTimeout(() => {
          try {
            // Build enhanced prompt
            const prompt = buildPrompt(formData);
            
            if (!prompt || prompt.trim().length === 0) {
              throw new Error('Generated prompt is empty');
            }
            
            // Display prompt
            const outputElement = document.getElementById('output');
            if (!outputElement) {
              throw new Error('Output element not found');
            }
            
            outputElement.textContent = prompt;
            outputElement.classList.remove('output-placeholder');
            
            // Store prompt
            appState.lastPrompt = prompt;
            
            // Show usage instructions with animation
            const instructionsElement = document.getElementById('usage-instructions');
            if (instructionsElement) {
              instructionsElement.style.display = 'block';
            }
            
            // Smooth scroll to output with offset
            setTimeout(() => {
              const outputSection = outputElement.closest('.output-section');
              if (outputSection) {
                outputSection.scrollIntoView({ 
                  behavior: 'smooth',
                  block: 'start' 
                });
              }
            }, 100);
            
            // Visual feedback
            showFieldSuccess('goal');
            showToast('Prompt generated successfully!', 'success');
            
          } catch (error) {
            console.error('Error building prompt:', error);
            showToast('Error generating prompt. Please try again.', 'error');
          } finally {
            setLoadingState(false);
          }
        }, 800); // Realistic loading time
        
      } catch (error) {
        console.error('Error in generatePrompt:', error);
        showToast('An unexpected error occurred', 'error');
        setLoadingState(false);
      }
    }

    // Helper function to safely get element values
    function getElementValue(elementId) {
      try {
        const element = document.getElementById(elementId);
        return element ? element.value.trim() : '';
      } catch (error) {
        console.error(`Error getting value for ${elementId}:`, error);
        return '';
      }
    }

    // Enhanced form validation with comprehensive checks
    function validateForm(formData) {
      const errors = [];
      
      try {
        // Required field validation
        if (!formData.goal) {
          errors.push({ field: 'goal', message: 'Goal is required' });
        } else if (formData.goal.length < 5) {
          errors.push({ field: 'goal', message: 'Goal must be at least 5 characters' });
        }
        
        // Length validations based on maxlength attributes
        const lengthChecks = [
          { field: 'role', max: 200, label: 'AI Role' },
          { field: 'goal', max: 300, label: 'Goal' },
          { field: 'context', max: 1000, label: 'Context' },
          { field: 'tone', max: 100, label: 'Tone/Style' },
          { field: 'constraints', max: 200, label: 'Constraints' },
          { field: 'examples', max: 500, label: 'Examples' }
        ];
        
        lengthChecks.forEach(check => {
          if (formData[check.field] && formData[check.field].length > check.max) {
            errors.push({ 
              field: check.field, 
              message: `${check.label} must be under ${check.max} characters` 
            });
          }
        });
        
        // Content quality validation
        if (formData.goal && formData.goal.toLowerCase().includes('test')) {
          // Allow test data for testing purposes
        }
        
      } catch (error) {
        console.error('Validation error:', error);
        errors.push({ field: 'goal', message: 'Validation error occurred' });
      }
      
      return {
        isValid: errors.length === 0,
        errors: errors
      };
    }

    // Enhanced prompt building logic with error handling
    function buildPrompt(formData) {
      try {
        let prompt = "";
        
        // Role section - most important, comes first
        if (formData.role) {
          prompt += `${formData.role}\n\n`;
        }
        
        // Task/Goal - core objective
        if (formData.goal) {
          prompt += `Your task: ${formData.goal}\n\n`;
        }
        
        // Context - important background
        if (formData.context) {
          prompt += `Context: ${formData.context}\n\n`;
        }
        
        // Format requirements
        if (formData.format) {
          const formatMap = {
            'paragraph': 'Provide your response in well-structured paragraphs',
            'list': 'Format your response as a clear, numbered or bulleted list',
            'table': 'Present information in a structured table format',
            'code': 'Provide code examples with proper formatting and comments',
            'dialogue': 'Write in dialogue or conversation format',
            'step-by-step': 'Break down your response into clear, sequential steps'
          };
          
          prompt += `Format: ${formatMap[formData.format] || formData.format}\n\n`;
        }
        
        // Style/Tone guidance
        if (formData.tone) {
          prompt += `Tone and style: ${formData.tone}\n\n`;
        }
        
        // Constraints and requirements
        if (formData.constraints) {
          prompt += `Important constraints: ${formData.constraints}\n\n`;
        }
        
        // Examples for guidance
        if (formData.examples) {
          prompt += `Examples of desired output:\n${formData.examples}\n\n`;
        }
        
        // Clear call to action
        prompt += "Please provide your response following all the above guidelines and requirements.";
        
        return prompt;
        
      } catch (error) {
        console.error('Error building prompt:', error);
        return 'Error: Could not build prompt. Please check your inputs and try again.';
      }
    }

    // Enhanced prompt refinement with error handling
    function refinePrompt() {
      try {
        const outputElement = document.getElementById('output');
        if (!outputElement) {
          showToast('Output element not found', 'error');
          return;
        }
        
        const currentPrompt = outputElement.textContent;
        
        if (!currentPrompt || currentPrompt.includes('Your custom-generated prompt will appear here') || currentPrompt.includes('Please cut and paste your custom generated prompt')) {
          showToast('Please generate a prompt first before refining it', 'error');
          return;
        }
        
        setLoadingState(true, 'refineBtn');
        
        setTimeout(() => {
          try {
            const refinedPrompt = currentPrompt + 
              "\n\n---\n\n" +
              "REFINEMENT INSTRUCTIONS:\n" +
              "Please refine and improve this prompt to make it more effective. Consider:\n" +
              "• More precise and specific language\n" +
              "• Better structure and organization\n" +
              "• Clearer instructions and expectations\n" +
              "• More detailed examples if needed\n" +
              "• Enhanced context where appropriate\n\n" +
              "Provide the refined version of the above prompt.";
            
            outputElement.textContent = refinedPrompt;
            appState.lastPrompt = refinedPrompt;
            
            // Keep usage instructions visible
            const instructionsElement = document.getElementById('usage-instructions');
            if (instructionsElement) {
              instructionsElement.style.display = 'block';
            }
            
            showToast('Prompt refined successfully!', 'success');
            
          } catch (error) {
            console.error('Error in refinement process:', error);
            showToast('Error refining prompt', 'error');
          } finally {
            setLoadingState(false, 'refineBtn');
          }
        }, 600);
        
      } catch (error) {
        console.error('Error in refinePrompt:', error);
        showToast('Error refining prompt', 'error');
        setLoadingState(false, 'refineBtn');
      }
    }

    // Enhanced clipboard functionality with multiple fallbacks
    async function copyPromptToClipboard() {
      try {
        const outputElement = document.getElementById('output');
        if (!outputElement) {
          showToast('Output element not found', 'error');
          return;
        }
        
        const promptText = outputElement.textContent;
        
        if (!promptText || promptText.includes('Your custom-generated prompt will appear here') || promptText.includes('Please cut and paste your custom generated prompt')) {
          showToast('No prompt to copy. Please generate a prompt first.', 'error');
          return;
        }
        
        let copySuccess = false;
        
        // Method 1: Modern Clipboard API (if available and secure context)
        if (navigator.clipboard && window.isSecureContext) {
          try {
            await navigator.clipboard.writeText(promptText);
            copySuccess = true;
          } catch (clipboardError) {
            console.warn('Clipboard API failed:', clipboardError);
          }
        }
        
        // Method 2: Fallback using document.execCommand
        if (!copySuccess) {
          try {
            const textArea = document.createElement('textarea');
            textArea.value = promptText;
            textArea.style.position = 'fixed';
            textArea.style.left = '-999999px';
            textArea.style.top = '-999999px';
            textArea.style.opacity = '0';
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            copySuccess = document.execCommand('copy');
            document.body.removeChild(textArea);
          } catch (execError) {
            console.warn('execCommand failed:', execError);
          }
        }
        
        if (copySuccess) {
          showCopySuccess();
          showToast('Prompt copied to clipboard!', 'success');
        } else {
          // Method 3: Manual selection as last resort
          selectTextInOutput();
          showToast('Please manually copy the selected text above', 'error');
        }
        
      } catch (error) {
        console.error('Copy failed completely:', error);
        showToast('Copy failed. Please manually select and copy the text.', 'error');
      }
    }

    // Helper function to select text in output with error handling
    function selectTextInOutput() {
      try {
        const outputElement = document.getElementById('output');
        if (!outputElement) return;
        
        if (window.getSelection && document.createRange) {
          const range = document.createRange();
          range.selectNodeContents(outputElement);
          
          const selection = window.getSelection();
          selection.removeAllRanges();
          selection.addRange(range);
        }
      } catch (error) {
        console.error('Text selection failed:', error);
      }
    }

    // Enhanced file saving with comprehensive error handling
    function savePrompt() {
      try {
        const outputElement = document.getElementById('output');
        if (!outputElement) {
          showToast('Output element not found', 'error');
          return;
        }
        
        const content = outputElement.textContent;
        
        if (!content || content.includes('Your custom-generated prompt will appear here') || content.includes('Please cut and paste your custom generated prompt')) {
          showToast('Please generate a prompt first before saving', 'error');
          return;
        }
        
        setLoadingState(true, 'saveBtn');
        
        // Simulate processing time
        setTimeout(() => {
          try {
            // Create filename with timestamp
            const now = new Date();
            const timestamp = now.toISOString().slice(0, 19).replace(/:/g, '-');
            const filename = `SmartPromptz_Prompt_${timestamp}.txt`;
            
            // Create and trigger download
            const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
            
            if (window.URL && window.URL.createObjectURL) {
              const url = URL.createObjectURL(blob);
              const a = document.createElement('a');
              a.href = url;
              a.download = filename;
              a.style.display = 'none';
              
              document.body.appendChild(a);
              a.click();
              document.body.removeChild(a);
              URL.revokeObjectURL(url);
              
              showFieldSuccess('constraints');
              showToast('Prompt saved successfully!', 'success');
            } else {
              throw new Error('File download not supported');
            }
            
          } catch (error) {
            console.error('Save failed:', error);
            showToast('Failed to save file. Please try copying the text instead.', 'error');
          } finally {
            setLoadingState(false, 'saveBtn');
          }
        }, 400);
        
      } catch (error) {
        console.error('Error in savePrompt:', error);
        showToast('An error occurred while saving', 'error');
        setLoadingState(false, 'saveBtn');
      }
    }

    // Enhanced UI feedback functions with null checking
    function showFieldError(fieldId, message) {
      try {
        const field = document.getElementById(fieldId);
        if (!field) {
          console.error(`Field not found: ${fieldId}`);
          return;
        }
        
        field.classList.add('error');
        
        // Remove existing error message
        clearFieldError(fieldId);
        
        // Add new error message
        const errorDiv = document.createElement('div');
        errorDiv.className = 'error-message';
        errorDiv.textContent = message;
        errorDiv.setAttribute('data-field', fieldId);
        
        if (field.parentNode) {
          field.parentNode.appendChild(errorDiv);
        }
        
        // Focus the field if it's the first error
        if (appState.validationErrors.length === 0) {
          field.focus();
        }
        
        appState.validationErrors.push(fieldId);
      } catch (error) {
        console.error('Error showing field error:', error);
      }
    }

    function clearFieldError(fieldId) {
      try {
        const existingError = document.querySelector(`.error-message[data-field="${fieldId}"]`);
        if (existingError && existingError.parentNode) {
          existingError.parentNode.removeChild(existingError);
        }
      } catch (error) {
        console.error('Error clearing field error:', error);
      }
    }

    function showFieldSuccess(fieldId) {
      try {
        const field = document.getElementById(fieldId);
        if (!field) return;
        
        field.classList.remove('error');
        field.classList.add('success');
        
        // Remove success class after animation
        setTimeout(() => {
          if (field) {
            field.classList.remove('success');
          }
        }, 2000);
      } catch (error) {
        console.error('Error showing field success:', error);
      }
    }

    function clearErrors() {
      try {
        // Remove all error states
        const errorElements = document.querySelectorAll('.error');
        errorElements.forEach(el => {
          el.classList.remove('error');
        });
        
        // Remove all error messages
        const errorMessages = document.querySelectorAll('.error-message');
        errorMessages.forEach(el => {
          if (el.parentNode) {
            el.parentNode.removeChild(el);
          }
        });
        
        appState.validationErrors = [];
      } catch (error) {
        console.error('Error clearing errors:', error);
      }
    }

    // Enhanced loading state management with safety checks
    function setLoadingState(isLoading, buttonId) {
      try {
        buttonId = buttonId || 'generateBtn';
        const button = document.getElementById(buttonId);
        if (!button) {
          console.error(`Button not found: ${buttonId}`);
          return;
        }
        
        appState.isGenerating = isLoading;
        
        if (isLoading) {
          button.classList.add('loading');
          button.disabled = true;
          const span = button.querySelector('span');
          if (span) span.style.opacity = '0';
        } else {
          button.classList.remove('loading');
          button.disabled = false;
          const span = button.querySelector('span');
          if (span) span.style.opacity = '1';
        }
      } catch (error) {
        console.error('Error setting loading state:', error);
      }
    }

    // Enhanced toast notification system with safety checks
    function showToast(message, type) {
      try {
        if (!message) return;
        
        type = type || 'info';
        
        // Remove existing toast
        hideToast();
        
        const toast = document.createElement('div');
        toast.className = `toast ${type}`;
        toast.textContent = message;
        toast.id = 'current-toast';
        
        document.body.appendChild(toast);
        
        // Trigger show animation
        setTimeout(() => {
          if (toast) {
            toast.classList.add('show');
          }
        }, 100);
        
        // Auto hide after 4 seconds
        setTimeout(() => {
          hideToast();
        }, 4000);
        
      } catch (error) {
        console.error('Error showing toast:', error);
      }
    }

    function hideToast() {
      try {
        const existingToast = document.getElementById('current-toast');
        if (existingToast) {
          existingToast.classList.remove('show');
          setTimeout(() => {
            if (existingToast && existingToast.parentNode) {
              existingToast.parentNode.removeChild(existingToast);
            }
          }, 300);
        }
      } catch (error) {
        console.error('Error hiding toast:', error);
      }
    }

    // Enhanced copy success feedback with safety checks
    function showCopySuccess() {
      try {
        const successElement = document.getElementById('copy-success');
        if (successElement) {
          successElement.style.display = 'inline';
          
          // Hide after 3 seconds
          setTimeout(() => {
            if (successElement) {
              successElement.style.display = 'none';
            }
          }, 3000);
        }
      } catch (error) {
        console.error('Error showing copy success:', error);
      }
    }

    // Enhanced initialization with comprehensive error handling
    function initializeApp() {
      try {
        if (appState.initialized) return;
        
        // Set initial focus safely
        const roleField = document.getElementById('role');
        if (roleField && typeof roleField.focus === 'function') {
          roleField.focus();
        }
        
        // Enhanced keyboard shortcuts with error handling
        document.addEventListener('keydown', function(e) {
          try {
            if (!e) return;
            
            // Prevent default for our shortcuts
            if ((e.ctrlKey || e.metaKey)) {
              switch(e.key) {
                case 'Enter':
                  e.preventDefault();
                  if (!appState.isGenerating) generatePrompt();
                  break;
                case 's':
                  e.preventDefault();
                  savePrompt();
                  break;
                case 'r':
                  e.preventDefault();
                  refinePrompt();
                  break;
              }
            }
            
            // Escape to clear errors
            if (e.key === 'Escape') {
              clearErrors();
              hideToast();
            }
          } catch (error) {
            console.error('Keyboard shortcut error:', error);
          }
        });
        
        // Add real-time validation with error handling
        const inputs = document.querySelectorAll('.form-input, .form-textarea, .form-select');
        inputs.forEach(input => {
          if (input && typeof input.addEventListener === 'function') {
            input.addEventListener('input', function() {
              try {
                // Clear error state on input
                if (this.classList.contains('error')) {
                  this.classList.remove('error');
                  clearFieldError(this.id);
                }
              } catch (error) {
                console.error('Input validation error:', error);
              }
            });
          }
        });
        
        // Initialize smooth animations safely
        const cards = document.querySelectorAll('.card-hover');
        cards.forEach((card, index) => {
          if (card) {
            card.style.animationDelay = `${index * 0.1}s`;
            card.style.animation = 'slideIn 0.6s ease forwards';
          }
        });
        
        appState.initialized = true;
        
        // Show welcome toast
        setTimeout(() => {
          showToast('Welcome to SmartPromptz! Start building your perfect prompt.', 'success');
        }, 1000);
        
      } catch (error) {
        console.error('Initialization error:', error);
        // Still try to show a toast even if initialization partially failed
        setTimeout(() => {
          showToast('App loaded with some limitations. Basic functionality should work.', 'error');
        }, 1000);
      }
    }

    // Enhanced event listeners with comprehensive error handling
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initializeApp);
    } else {
      // DOM is already ready
      initializeApp();
    }

    // Global error handlers for better debugging
    window.addEventListener('error', function(e) {
      console.error('Global error:', e.error || e.message);
      if (typeof showToast === 'function') {
        showToast('An unexpected error occurred. Please refresh if issues persist.', 'error');
      }
    });
  </script>
</body>
</html>